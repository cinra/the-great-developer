# インフラストラクチャー > 基礎 > セキュリティ

## 課題

- [ ] ネットワーク分離（ゲスト・パブリック）について理解する
- [ ] パスワード等、秘密情報の管理について理解する

---

## 解説

かなり範囲が広いため、ここでのセキュリティは、社内セキュリティをベースとした？基本的な物を記載します。

NOTE: 取り急ぎ最低限の事を記載

### 小規模ネットワーク

小規模ネットワークとは、「ルーター」によって、ネットワークを外側（WAN）と内側（LAN）に分離し、
内部で構成されている１つのネットワークの事を指します。

このローカルネットワーク内に接続しているコンピュータは、ルーターによって自動的にIPアドレスが割り振られており、コンピュータ同士のデータのやり取り等が可能です。これを「同一ネットワーク」と言ったりします。（ルーター側でDHCP設定がオンになっている前提です）

同一ネットワーク内に存在するコンピュータは互いのデータのやり取りには何かと便利なのですが、接続しているコンピュータのホスト名や、IPアドレス、なんなら通信内容（パケット）も全て見えるので、第3者を同一ネットワークに接続させない設定をかけたり、機密データを扱うコンピュータは別のネットワークにしておく事が望ましいです。

そこで基本的には、「ネットワークの分離（セグメント化）」という対策を行います。  
例えば、以下はそれぞれ別ネットワークの扱いになります。

セグメントA：`192.168.1.1~230`  
セグメントB：`192.168.2.1~230`

セグメントAの中に存在している末尾2番〜230番までのコンピュータは、互いに疎通が可能ですが、セグメントBに存在しているコンピュータからセグメントAのIPを叩いても、疎通しません。  
（セグメント間で疎通する構成もありますが、今回は隔離目的なので疎通できない前提とします）

これらをゲストネットワークと、社内ネットワークとして分離しておく事で、最低限のセキュリティが確保できます。

<a name="infra_security_firewall"></a>
### ファイアウォール

まず、個々のコンピュータが互いにデータを伝送するためには、「IPアドレス」の他に、「ポート番号」が必要になります。  
ポート番号とは、コンピュータがその通信に使用するプログラムを識別するための番号の事です。

分かりづらいと思うのでそれぞれを置き換えると以下のようになります。  

| IPアドレス＝住所 | ポート番号＝人、または「郵便局」等のサービス…？ | 識別 |
|:-:|:-:|:-:|
| `XXX.XXX.XXX.XXX` | `:80` | HTTP |
| `XXX.XXX.XXX.XXX` | `:443` | HTTPS |

細かい点は省いていますが、このように、「どこの、誰」とする事で、コンピュータがそれぞれの要求に対して適切なプログラムで応答しています。  

グローバルネットワークは現実の「屋外」と変わりませんので、全てのアクセスを中に通してしまうと当然危険で、
「来客」を正しく識別して、通過・拒否させる必要があり、この役割を担っているのが、ファイアウォールです。

※ 超ざっくり記載していますが、外から内に来る「受信」だけでなく内から外に出る「送信」も監視してます。
※ もう少し掘り下げると、TCP／UDPなどという単語も出てきますが、ここでは一旦スルーして頂いて問題ありません。

ファイアウォールは主に、以下の場所で動作しています。

- ルーター
- 各コンピュータのOS自体の設定
- 各コンピュータのOS上のアプリケーション（セキュリティソフト等）

基本的には、外から中への受信はほとんど「reject（破棄）」、中から外の送信は全て「pass（許可）」となっています。  
が、例えば「Webサーバー」として公開する場合、「HTTP」を使用するなら「ポート80番」を公開しないと外からアクセスできないので、「ポート開放」という作業を行います。これは単純にファイアウォールに対して、「外からの80番へのアクセスを、IPアドレス問わず全てpassしろ」といった設定をするだけで可能です。

最後にポート番号の種類について記載します。  
ポート番号には「ウェルノウンポート」と「登録済ポート」の２種類があります。

#### ウェルノウンポート（0-1023）

一般的なポート番号として、「IANA」という標準化団体が一元管理しており、それぞれ有名なアプリケーション（サービス）が使用しているポートです。  
ユーザーが自由に使う事はできませんが、アプリケーション側で「使用するポート」自体の変更は可能な事が多いです。

#### 登録済ポート（1024-49151）

特定のアプリケーション（サービス）が既に予約しているポートの事です。  
ただし、該当のアプリケーション（サービス）が立ち上がっていない等で競合していなければユーザーは自由に使う事ができます。

#### 関連用語

- ホワイトリスト、ブラックリスト方式

---


## 参考リンク
