# Vagrant

Vagrantとは、仮想マシンの構築ツールです。

例えば、「ローカル環境」でウェブサイトを開発しようと思った時に、  
各々でサーバーやデータベースの環境構築を行うと、  
OS（Mac／Windows）や「バージョン」、「コンフィグ」に差異が出て複数人での開発で不都合が生じます。

そこで、「VirtualBox」という、仮想環境を動かすためのアプリケーションを導入します。  
仮想環境とは、「OSの中でもう１つ別のOSを動かす」ものです。

つまり、現在使用しているOSがMacであれば、「Macの中で、Windowsを起動する事ができる、という事です。

この技術を利用して、一般的にサーバーに用いられる「LinuxベースのOS」を動かします。

ただし、起動したばかりのLinuxには、何の設定も無いので、「Webサーバー」として動かすためのいわゆる「LAMP」の設定が必要になります。  
Vagrantが出来る事は、「仮想環境の起動」までなので、設定については ansible を参照してください。

それではVagrantを実際に使って練習してみましょう。

## 課題

### 準備

- [Vagrant - HashiCorp](https://www.vagrantup.com/) から、VagrantのインストーラーをDLしてインストールします。
- `vagrant --version` でバージョンが表示される事を確認します。
- cinraのリポジトリから、project-templateをcloneします。

### 実践

- [ ] CUIでproject-templateのルートに移動して、vagrantの起動コマンドを打ちます。

補足：コマンドラインで何やらダウンロードし始めたら、それはVagrant Boxです。  
Vagrant Boxとは、Box Fileと呼ばれる物で、つまり実体はOSのイメージデータなのですが、Vagrantの設定を含めて別途書き出された物です。

- [ ] 起動したら一度、終了コマンドでシャットダウンさせてください。

補足：ここまでで何が起きたのかですが、まず、Vagrantの実行には、通常、設定ファイルが必要です。  
この設定ファイルが、project-templateのルートディレクトリに存在している「Vagrantfile」になります。

設定ファイルがある状態で、起動コマンドを打ち込むと、内容に従って、自動的に仮想OSが起動します。  
この時、仮想OSの事を「ゲストマシン」、仮想OSを動かしている側のOSの事を「ホストマシン」といいます。

設定ファイルの内容としては、以下のような事が記載されています。

- Box Fileのダウンロード先
- ネットワーク設定
- 同期フォルダ（指定したフォルダをホストとゲスト間で同期する）
- 仮想環境で使用するメモリの設定
- ansibleの実行コマンド

基本的な使い方は以上になります。
設定の記法については、参考リンクをご確認ください。

---

## コマンド解説

### vagrant up

vagrantfile の設定に沿ってゲストOSを立ち上げます。

### vagrant halt

ゲストOSをシャットダウンします。

---

## 参考リンク

[よく使うVagrantfileの設定のまとめ](https://www.virment.com/vagrantfile-settings/)　← 日本語ですが2015年の記事なので古いかも…
[Vagrantfile - HashiCorp](https://www.vagrantup.com/docs/vagrantfile/) ← 英語ですが、公式なので間違いありません